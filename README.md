# Новостной портал
![Django CI](https://github.com/ribondareva/NewsPortal/actions/workflows/ci.yml/badge.svg)

Этот проект представляет собой новостной портал, где пользователи могут просматривать новости, подписываться на категории, лайкать, дизлайкать, комментировать посты и становиться авторами. Платформа также предоставляет функции персонализации и интерактивности, такие как уведомления о новых постах и возможность изменять тему интерфейса в зависимости от времени суток.
Также в проекте добавлены pre-commit хуки, линтер проверяет текст и запускает тесты. Если все прошло успешно, происходит коммит.

## Функции
### 1. **Регистрация и аутентификация пользователей**
- Регистрация через e-mail.
- Регистрация через Яндекс аккаунт.
- Подтверждение e-mail через код для завершения регистрации.
- Доступ к персонализированным функциям после регистрации.
### 2. **Публикация и редактирование постов**
- Пользователи могут стать авторами и публиковать свои посты.
- Каждый пост включает:
  - Заголовок: Краткое название поста.
  - Контент: Текст с возможностью добавления изображений, встроенных видео.
  - Рейтинг: Количество лайков и дизлайков у этого поста.
- Посты можно редактировать и удалять.
### 3. **Категории и фильтрация новостей**
- Новости могут быть отнесены к одной из категорий.
- Пользователи могут подписываться на категории, чтобы получать уведомления о новых постах.
- Возможность фильтрации постов по категории, названию и дате создания (закомментировано в коде).
### 4. **Комментарии к постам**
- Пользователи могут оставлять комментарии под постами.
- Каждый комментарий связан с конкретным постом.
- Имеет свое количество лайков и дизлайков.
### 5. **Пагинация и уведомления**
- Внедрена пагинация для отображения новостей на нескольких страницах.
- Пользователи получают уведомления о новых постах в любимых категориях.
### 6. **Интернационализация и локализация**
- Пользователь может выбрать часовой пояс, и на сайте будет отображаться текущее время в его часовом поясе.
- В зависимости от времени суток тема интерфейса меняется с темной на светлую.
- Реализован перевод нескольких постов и страниц на английский язык.

---

## Используемые технологии
- **Backend**: Django (с использованием Celery для асинхронных задач, таких как отправка уведомлений).
- **Frontend**: HTML/CSS, шаблоны Django.
- **База данных**: База данных: SQLite.
- **E-mail уведомления**: E-mail уведомления: SMTP для отправки писем.
- **OAuth2 для аутентификации через Яндекс**: используем библиотеку для интеграции с Яндекс OAuth2.
- **Docker + Docker Compose** для упрощения настройки всех контейнеров
- **GitHub Actions — CI/CD-среда.** Проект настроен на автоматический запуск тестов при каждом push или pull request с использованием GitHub Actions и pytest. 
  Используемые технологии:
    - pytest — основной тестовый фреймворк
    - pytest-django — плагин для корректной работы с Django
    - SQLite — тестовая база данных по умолчанию
---

## Инструкция по установке

### 1. Клонирование репозитория
```
git clone https://github.com/ribondareva/NewsPortal.git
cd newsportal
```

### 2. Настройка окружения
Такой файл .env должен быть заполнен пользователем с его реальными данными для настройки почтовых сервисов и других параметров, а также для конфигурации Celery и OAuth2 для аутентификации через Яндекс.
Создайте файл .env в корневой директории проекта со следующим содержимым:
```
# Основные настройки
SITE_URL=http://127.0.0.1:8000

# Настройки почты
EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend
EMAIL_HOST=smtp.yandex.ru
EMAIL_PORT=465
EMAIL_HOST_USER=<ваш_email>
EMAIL_HOST_PASSWORD=<ваш_пароль_от_email>
EMAIL_USE_TLS=False
EMAIL_USE_SSL=True
DEFAULT_FROM_EMAIL=<ваш_email>
SERVER_EMAIL=<ваш_email>

# Администраторы
ADMINS=[("Администратор", "<ваш_email>")]
MANAGERS=[("Менеджер", "<ваш_email>")]

# Celery настройки
CELERY_BROKER_URL=redis://localhost:6379
CELERY_RESULT_BACKEND=redis://localhost:6379
CELERY_ACCEPT_CONTENT=application/json
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json

# Настройки для OAuth2 Яндекс
YANDEX_OAUTH_CLIENT_ID=<ваш_client_id>
YANDEX_OAUTH_CLIENT_SECRET=<ваш_client_secret>
YANDEX_OAUTH_REDIRECT_URI=http://127.0.0.1:8000/accounts/yandex/callback/
```
### 3. Применение миграций
```
python manage.py migrate
```
### 4. Установите Docker и Docker Compose
### 5. Соберите и запустите контейнеры:
```
docker-compose up --build
```
### 6. Доступ к приложению
Основные маршруты приложения:
- Начальная страница:
```
http://localhost:8000
```
- Страница профиля пользователя (у зарегистрированных пользователей есть кнопка "Стать автором"):
```
http://localhost:8000/profile/
```
- Страница со всеми постами:
```
http://localhost:8000/post/
```
- Страница со всеми статьями:
```
http://localhost:8000/post/articles/
```
- Страница со всеми новостями:
```
http://localhost:8000/post/news/
```
- Определенный пост
```
http://localhost:8000/post/42/
```
- Написать комментарий к определенному посту:
```
http://localhost:8000/post/42/comment/
```
- Все посты по определенной категории
```
http://localhost:8000/post/categories/1
```
- Страница входа:
```
http://localhost:8000/accounts/login/
```
- Страница регистрации:
```
http://localhost:8000/accounts/signup/
```
